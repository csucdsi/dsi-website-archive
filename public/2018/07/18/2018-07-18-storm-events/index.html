<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title>Measuring Variation in the Empirical Storm Season Over Time &middot; </title>
        <meta name="description" content="Introduction This blog post attempts an analysis of the annual variability of dates on which storms formed during the years 1950 to 2016. Throughout, the word storm will refer to named tropical or subtropical cyclones in the Atlantic Ocean. The inspiration of this analysis came from a CSU, Chico campus seminar.
During the Fall semester of 2017, CSU, Chico&rsquo;s Dr. Ann Bykerk-Kauffman gave one of three talks at the Department of Geological and Environmental Sciences seminar titled 2017 Hurricane Talk.">
        <meta name="HandheldFriendly" content="True">
        <meta name="MobileOptimized" content="320">
        <meta name="generator" content="Hugo 0.75.1" />
        <meta name="robots" content="index,follow">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <link rel="stylesheet" href="/dist/styles.css">
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,400,600,700,300&subset=latin,cyrillic-ext,latin-ext,cyrillic">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
        
        
    </head>
    <body>
        
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-122708636-1', 'auto');
	
	ga('send', 'pageview');
}
</script>


        <div id="wrapper">
            <header class="site-header">
                <div class="container">
                    <div class="site-title-wrapper">
                        
                            <h1 class="site-title">
                                <a title="CSUC DSI" href="/">CSUC DSI</a>
                            </h1>
                        
                        <a class="button-square" href="/index.xml"><i class="fa fa-rss"></i></a>
                        
                        
                        
                            <a class="button-square button-social hint--top" data-hint="Github" title="Github" href="https://github.com/csucdsi">
                                <i class="fa fa-github-alt"></i>
                            </a>
                        
                        
                        
                        
                        
                            <a class="button-square button-social hint--top" data-hint="Email" title="Email" href="mailto:datascience@csuchico.edu">
                                <i class="fa fa-envelope"></i>
                            </a>
                        
                    </div>

                    <ul class="site-nav">
                        
    <li class="site-nav-item">
        <a title="News" href="/">News</a>
    </li>

    <li class="site-nav-item">
        <a title="About" href="/page/about/">About</a>
    </li>

    <li class="site-nav-item">
        <a title="Training" href="/page/courses/">Training</a>
    </li>

    <li class="site-nav-item">
        <a title="Calendar" href="/page/events/">Calendar</a>
    </li>

    <li class="site-nav-item">
        <a title="Contact" href="/page/contact/">Contact</a>
    </li>

                    </ul>
                </div>
            </header>

            <div id="container">


<div class="container">
    <article class="post-container" itemscope="" itemtype="http://schema.org/BlogPosting">
        <header class="post-header">
    <h1 class="post-title" itemprop="name headline">Measuring Variation in the Empirical Storm Season Over Time</h1>
    
    <p class="post-date">
        <span>Published <time datetime="2018-07-18" itemprop="datePublished">Wed, Jul 18, 2018</time></span>
        <span>by</span>
        <span itemscope="" itemprop="author" itemtype="https://schema.org/Person">
            <span itemprop="name">
                <a href="#" itemprop="url" rel="author">Edward Roualdes</a>
            </span>
        </span>
    </p>
</header>

        <div class="post-content clearfix" itemprop="articleBody">
    

    <!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<h1 id="introduction">Introduction</h1>
<p>This blog post attempts an analysis of the annual variability of dates on which storms formed during the years 1950 to 2016.  Throughout, the word storm will refer to named tropical or subtropical cyclones in the Atlantic Ocean.  The inspiration of this analysis came from a <a href="http://www.csuchico.edu/">CSU, Chico</a> campus seminar.</p>
<p>During the Fall semester of 2017, CSU, Chico&rsquo;s <a href="http://www.csuchico.edu/%7eabykerk-kauffman/">Dr. Ann Bykerk-Kauffman</a> gave one of three talks at the <a href="http://www.csuchico.edu/geos/index.shtml">Department of Geological and Environmental Sciences</a> seminar titled <a href="http://www.csuchico.edu/geos/stories/17.09.14_HurricaneTalk.shtml">2017 Hurricane Talk</a>.  Part of Dr. Bykerk-Kauffman&rsquo;s presentation included data from the National Oceanic and Atmospheric Administration&rsquo;s National Hurricane Center&rsquo;s (NHC) Data Archive: <a href="https://www.nhc.noaa.gov/data/#hurdat">https://www.nhc.noaa.gov/data/#hurdat</a> [Landsea:2013].  After her talk, Dr. David M. Hassenzahl, Dean of the <a href="https://www.csuchico.edu/nsci/index.shtml">College of Natural Sciences</a>, asked a great question, which I&rsquo;ll try to paraphrase:  Is the variation of the empirical storm season changing over time?</p>
<p>One possible way to interpret the phrase <em>variation of the empirical storm season</em> goes like this.  The <a href="https://en.wikipedia.org/wiki/Atlantic_hurricane_season">official storm season</a> is June 01 to November 30.  The official storms season proves useful as a contrast to an empirical storm season.  The word empirical refers to the actual dates for which the named storms in any given year form.  Just because we define a storm season, does not mean all the storms form within the official storm season.  Some years contain some storms outside the official storm season, and some years contain all storms within the official storm season &ndash; as we&rsquo;ll see later, no year in our data set has all storms outside of the official storm season.  Since there is not a direct correspondence between the official storm season and the empirical storm season, it&rsquo;s useful to separate these two phrases.  Last, the word variation describes the average distance (measured in days) from the middle of the empirical storm season.</p>
<p>There are of course other ways to measure the variation of the empirical storm season.  This blog post attempts to quantify the annual variation of the empirical storm season in three different ways.  The first attempt follows the logic in the last paragraph.  The second attempt defines a percentage of storms that form outside of the official storm season, relative to the total number of storms in each year.  The last attempt hypothesizes a probability distribution that produces storms throughout the year, and then asks if this distribution of storms changes over time.</p>
<p>The rest of this post proceeds as follows.  Section 3 discusses some related research and briefly compares this analysis to previous efforts.  Section 4 walks through the data preparation necessary for our analyses.  Section 5 contains the bulk of the analysis, for which multiple measurements of variation of the storm season are considered as a time series.  Here, we focus on Atlantic storms from the years 1950 to 2016.  However, no qualitative, and only minor quantitative, differences are found by analyzing Pacific Ocean storms simiarly.  The post is concluded in Section 6, and Sections 7 and 8 offer my appreciation to those who directly and indirectly made this analysis possible.</p>
<h1 id="related-research">Related Research</h1>
<p>Much research effort is spent on storms of the Atlantic Ocean.  For instance, just a quick glance of <a href="http://www.noaa.gov/media-releases">NOAA&rsquo;s media releases</a> shows that much of their latest research revolves around the storm season.  With a little more attention to their articles, it&rsquo;s clear that this work focuses on storm intensity and/or number of storms.  Less research is devoted to the variation in the storm season.</p>
<p>In 2008, Kossin tried to answer &ldquo;Is the North Atlantic hurricane season getting longer?&rdquo; [Kossin:2008].  Based on the sign of his point estimates, Kossin concluded that the hurricane season is indeed getting longer.  This was the conclusion despite high uncertainty in the point estimates.  For the analysis, Kossin used quantile regression on the dates for which storms formed within each year.  We note that quantile regression inherently treats the observations as independent acorss time.</p>
<p>Despite no statistically significant finding, due to high uncertainty, at least two websites picked up on Kossin&rsquo;s article: <a href="https://www.livescience.com/2686-hurricane-season-longer.html">Live Science</a> and <a href="https://www.wunderground.com/blog/JeffMasters/is-the-atlantic-hurricane-season-getting-longer.html">Wunderground</a>.  Within each story, the uncertainty is glossed over.  This stands in stark contrast to Karloski&rsquo;s summary of Kossin&rsquo;s work [Karloski:2016].  Karloski replicated Kossin&rsquo;s work and provided stronger wording about the uncertain estimates of an increase in variation.</p>
<p>In 2017, evidence of correlations in the storm seasons across time surfaced in the article &ldquo;Variation of the Tropical Cyclone Season Start in the Western North Pacific&rdquo; [Kim:2017].  Specifically, the authors found that a strong El Niño year will delay the start of the storm season in the following year.  This analysis, too, treated the annual measurements of the storm season as independent across time.  Using linear regression applied to a statistic similar to the interquartile range (using percentiles 95% and 5%, instead of 75% and 25%), Kim found a statistically insignificant shrink in the storm season.</p>
<p>Like these previous studies, the following analysis attempts to measure the variation in the storm season by using the dates within the year for which named storms first formed.  Unlike these previous studies, this study fits a model more common to time series data.  We use a semilocal linear trend model to account for potential autocorrelation in the storm season.  Further, we introduce novel measures of variation of the storm season.</p>
<h1 id="data-preparation">Data Preparation</h1>
<p>We begin by setting up the working environment: loading <a href="https://www.python.org">Python</a> and various packages common to Python&rsquo;s data science community, including <a href="http://mc-stan.org">Stan</a> the probabilistic programming language which we&rsquo;ll use to fit a Bayesian structural time series model.</p>
<p>The HURDAT2 [Landsea:2013] data used here was processed from the NHC data archive to enable this analysis.  The source code and data are available on <a href="https://github.com/roualdes/stormevents">GitHub</a>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> statsmodels.api <span style="color:#f92672">as</span> sm
<span style="color:#f92672">import</span> pandas <span style="color:#f92672">as</span> pd
<span style="color:#f92672">import</span> numpy <span style="color:#f92672">as</span> np
<span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#f92672">as</span> plt
<span style="color:#f92672">import</span> matplotlib.dates <span style="color:#f92672">as</span> mdates
<span style="color:#f92672">from</span> matplotlib <span style="color:#f92672">import</span> rc
<span style="color:#f92672">import</span> bplot <span style="color:#f92672">as</span> bp
<span style="color:#f92672">import</span> datetime
<span style="color:#f92672">import</span> pystan
<span style="color:#f92672">import</span> stan_utility
<span style="color:#f92672">import</span> requests
<span style="color:#f92672">%</span>matplotlib inline
rc(<span style="color:#e6db74">&#39;text&#39;</span>, usetex<span style="color:#f92672">=</span>True)
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_csv(<span style="color:#e6db74">&#39;https://raw.githubusercontent.com/roualdes/stormevents/master/data.csv&#39;</span>)
</code></pre></div><p>To properly work with dates in Python, we convert dates, from the format YYYMMDD, into formal datetime objects.  We assign numbers to dates by counting days since 0001-01-01 UTC plus 1; see <a href="https://matplotlib.org/api/dates_api.html">matplotlib dates</a> for technical details.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df[<span style="color:#e6db74">&#39;date&#39;</span>] <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>to_datetime(df[<span style="color:#e6db74">&#39;date&#39;</span>], format<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;%Y%m</span><span style="color:#e6db74">%d</span><span style="color:#e6db74">&#39;</span>)
df<span style="color:#f92672">.</span>drop_duplicates(<span style="color:#e6db74">&#39;name&#39;</span>, inplace<span style="color:#f92672">=</span>True) <span style="color:#75715e"># don&#39;t double count storms</span>
df[<span style="color:#e6db74">&#39;year&#39;</span>] <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>date<span style="color:#f92672">.</span>dt<span style="color:#f92672">.</span>year 
df <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>loc[df[<span style="color:#e6db74">&#39;year&#39;</span>] <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">1950</span>]
df[<span style="color:#e6db74">&#39;month&#39;</span>] <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>date<span style="color:#f92672">.</span>dt<span style="color:#f92672">.</span>month
df[<span style="color:#e6db74">&#39;cnum_dates&#39;</span>] <span style="color:#f92672">=</span> mdates<span style="color:#f92672">.</span>date2num([datetime<span style="color:#f92672">.</span>datetime(<span style="color:#ae81ff">2018</span>, d<span style="color:#f92672">.</span>month, d<span style="color:#f92672">.</span>day)                     
                         <span style="color:#66d9ef">for</span> _, d <span style="color:#f92672">in</span> df[<span style="color:#e6db74">&#39;date&#39;</span>]<span style="color:#f92672">.</span>dropna()<span style="color:#f92672">.</span>iteritems()]) 
df[<span style="color:#e6db74">&#39;num_dates&#39;</span>] <span style="color:#f92672">=</span> mdates<span style="color:#f92672">.</span>date2num([datetime<span style="color:#f92672">.</span>datetime(d<span style="color:#f92672">.</span>year, d<span style="color:#f92672">.</span>month, d<span style="color:#f92672">.</span>day)                     
                         <span style="color:#66d9ef">for</span> _, d <span style="color:#f92672">in</span> df[<span style="color:#e6db74">&#39;date&#39;</span>]<span style="color:#f92672">.</span>iteritems()])
df <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>loc[df[<span style="color:#e6db74">&#39;name&#39;</span>]<span style="color:#f92672">.</span>str<span style="color:#f92672">.</span>contains(<span style="color:#e6db74">&#39;^AL&#39;</span>)]<span style="color:#f92672">.</span>copy() <span style="color:#75715e"># Atlantic</span>
df<span style="color:#f92672">.</span>head()
</code></pre></div><!-- raw HTML omitted -->
<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}
</code></pre>
<p><!-- raw HTML omitted --></p>
<!-- raw HTML omitted -->
<p>With dates properly set up, we can easily visualize the total number of storms each year. As expected, 2005 stands out as a sensational year for Atlantic Ocean storms.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">fig, ax <span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>subplots(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">5</span>))
ax<span style="color:#f92672">.</span>cla()
bp<span style="color:#f92672">.</span>curve(df[<span style="color:#e6db74">&#39;year&#39;</span>]<span style="color:#f92672">.</span>unique(), 
         df[<span style="color:#e6db74">&#39;date&#39;</span>]<span style="color:#f92672">.</span>dt<span style="color:#f92672">.</span>year<span style="color:#f92672">.</span>value_counts()<span style="color:#f92672">.</span>sort_index())
plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#39;Year&#39;</span>, fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">20</span>)
plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#39;Number of storms&#39;</span>, fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">20</span>)
plt<span style="color:#f92672">.</span>tight_layout()
</code></pre></div><p><img src="/post/stormevents_files/stormevents_13_0.png" alt=""></p>
<p>Or we can sum, within each month, the number storms that formed in the Atlantic Ocean.  September appears to be the most common month for a storm.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df[<span style="color:#e6db74">&#39;date&#39;</span>]<span style="color:#f92672">.</span>dt<span style="color:#f92672">.</span>month<span style="color:#f92672">.</span>value_counts()<span style="color:#f92672">.</span>sort_index()
</code></pre></div><pre><code>1       3
2       1
4       5
5      25
6      73
7     113
8     251
9     332
10    163
11     47
12     11
Name: date, dtype: int64
</code></pre>
<p>Similar information is displayed with a histogram.  The histogram is nice because we can see how well the official storm season captures the highest density of storms.  Like above, the plot below is aggregated over all the years for which we have data.
<!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">storm_season <span style="color:#f92672">=</span> mdates<span style="color:#f92672">.</span>date2num([datetime<span style="color:#f92672">.</span>datetime(<span style="color:#ae81ff">2018</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">1</span>), 
                                datetime<span style="color:#f92672">.</span>datetime(<span style="color:#ae81ff">2018</span>, <span style="color:#ae81ff">11</span>, <span style="color:#ae81ff">30</span>)])

fig, ax <span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>subplots(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">5</span>))
ax<span style="color:#f92672">.</span>cla()      
bp<span style="color:#f92672">.</span>histogram(df[<span style="color:#e6db74">&#39;cnum_dates&#39;</span>], bins<span style="color:#f92672">=</span><span style="color:#ae81ff">365</span><span style="color:#f92672">//</span><span style="color:#ae81ff">4</span>)
bp<span style="color:#f92672">.</span>density(df[<span style="color:#e6db74">&#39;cnum_dates&#39;</span>], alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.25</span>) 
bp<span style="color:#f92672">.</span>rug(storm_season, markersize<span style="color:#f92672">=</span><span style="color:#ae81ff">50</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;tab:red&#39;</span>)
plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#39;Month&#39;</span>, fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">20</span>)
plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#39;Density&#39;</span>, fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">20</span>)      
plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#39;Average Density of Storms&#39;</span>, fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">20</span>)
ax<span style="color:#f92672">.</span>set_xlim([df[<span style="color:#e6db74">&#39;cnum_dates&#39;</span>]<span style="color:#f92672">.</span>min(), df[<span style="color:#e6db74">&#39;cnum_dates&#39;</span>]<span style="color:#f92672">.</span>max()])  
ax<span style="color:#f92672">.</span>xaxis<span style="color:#f92672">.</span>set_major_locator(mdates<span style="color:#f92672">.</span>AutoDateLocator())                                 
ax<span style="color:#f92672">.</span>xaxis<span style="color:#f92672">.</span>set_major_formatter(mdates<span style="color:#f92672">.</span>DateFormatter(<span style="color:#e6db74">&#39;%m&#39;</span>))                          
plt<span style="color:#f92672">.</span>tight_layout()
</code></pre></div><p><img src="/post/stormevents_files/stormevents_17_0.png" alt=""></p>
<p>Averaged across all years, there is about 10% of storms that fall outside of the official storm season.  Below is the calculation of the percentage of storms within the official storm season.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">np<span style="color:#f92672">.</span>sum((df[<span style="color:#e6db74">&#39;cnum_dates&#39;</span>] <span style="color:#f92672">&gt;</span> storm_season[<span style="color:#ae81ff">0</span>]) <span style="color:#f92672">&amp;</span> (df[<span style="color:#e6db74">&#39;cnum_dates&#39;</span>] <span style="color:#f92672">&lt;</span> storm_season[<span style="color:#ae81ff">1</span>])) <span style="color:#f92672">/</span> df<span style="color:#f92672">.</span>shape[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">*</span> <span style="color:#ae81ff">100</span>
</code></pre></div><pre><code>95.5078125
</code></pre>
<h1 id="analysis">Analysis</h1>
<h2 id="has-the-variation-in-the-empirical-storm-season-changed-over-time">Has the variation in the empirical storm season changed over time?</h2>
<p>In an effort to answer Dean Hassenzahl&rsquo;s question, we attempt to measure the variation of the empirical storm season year over year.  To measure such variation, we will use the <a href="https://en.wikipedia.org/wiki/Median_absolute_deviation">median absolute deviation</a> (MAD) statistic.  The MAD statistic is an estimator of the population standard deviation σ, which is based on the median instead of the mean making it more robust to potential outliers.</p>
<p>To measure the variation of the emprical storm season over time, first consider a year $Y$.  In year $Y$, there will be a handful of storms that occur at different times.  Recall, we converted dates to numbers as per the discussion above in Section Data Preparation.  Define the median storm date as the date corresponding to the median of the numbers that represent the storms' dates.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df[<span style="color:#e6db74">&#39;median&#39;</span>] <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>groupby(<span style="color:#e6db74">&#39;year&#39;</span>)[<span style="color:#e6db74">&#39;num_dates&#39;</span>]<span style="color:#f92672">.</span>transform(<span style="color:#66d9ef">lambda</span> x: x<span style="color:#f92672">.</span>median())
df[<span style="color:#e6db74">&#39;median_date&#39;</span>] <span style="color:#f92672">=</span> mdates<span style="color:#f92672">.</span>num2date(df[<span style="color:#e6db74">&#39;median&#39;</span>])
</code></pre></div><p>The plot below depicts this visually for the year 2005.  The histogram of storms in 2005 appears in blue, as do the vertical ticks representing each storm.  The median storm date appears as the taller, red tick.
<!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">idx_2005 <span style="color:#f92672">=</span> df[<span style="color:#e6db74">&#39;year&#39;</span>] <span style="color:#f92672">==</span> <span style="color:#ae81ff">2005</span>
fig, ax <span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>subplots(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">5</span>))
ax<span style="color:#f92672">.</span>cla()
bp<span style="color:#f92672">.</span>histogram(df[<span style="color:#e6db74">&#39;num_dates&#39;</span>]<span style="color:#f92672">.</span>loc[idx_2005], bins<span style="color:#f92672">=</span><span style="color:#ae81ff">365</span><span style="color:#f92672">//</span><span style="color:#ae81ff">30</span>)
bp<span style="color:#f92672">.</span>rug(df[<span style="color:#e6db74">&#39;num_dates&#39;</span>]<span style="color:#f92672">.</span>loc[idx_2005]<span style="color:#f92672">.</span>values, markersize<span style="color:#f92672">=</span><span style="color:#ae81ff">20</span>)
bp<span style="color:#f92672">.</span>rug(df[<span style="color:#e6db74">&#39;median&#39;</span>]<span style="color:#f92672">.</span>loc[idx_2005]<span style="color:#f92672">.</span>values[:<span style="color:#ae81ff">1</span>], markersize<span style="color:#f92672">=</span><span style="color:#ae81ff">50</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;tab:red&#39;</span>)
plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#39;Month&#39;</span>, fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">20</span>)
plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#39;Density&#39;</span>, fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">20</span>)      
plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#39;Density of Storms in 2005&#39;</span>, fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">20</span>)
ax<span style="color:#f92672">.</span>set_xlim([datetime<span style="color:#f92672">.</span>datetime(<span style="color:#ae81ff">2005</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>), 
             datetime<span style="color:#f92672">.</span>datetime(<span style="color:#ae81ff">2005</span>, <span style="color:#ae81ff">12</span>, <span style="color:#ae81ff">1</span>)])  
ax<span style="color:#f92672">.</span>xaxis<span style="color:#f92672">.</span>set_major_locator(mdates<span style="color:#f92672">.</span>AutoDateLocator())                                 
ax<span style="color:#f92672">.</span>xaxis<span style="color:#f92672">.</span>set_major_formatter(mdates<span style="color:#f92672">.</span>DateFormatter(<span style="color:#e6db74">&#39;%m&#39;</span>)) 
plt<span style="color:#f92672">.</span>tight_layout()
</code></pre></div><p><img src="/post/stormevents_files/stormevents_25_0.png" alt=""></p>
<p>By this definition, across all the years, the median storm dates generaly fall in August or September.  The following table depicts the counts of the median storm date within each numbered month, over all the years for which we have data.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df<span style="color:#f92672">.</span>drop_duplicates(<span style="color:#e6db74">&#39;year&#39;</span>, inplace<span style="color:#f92672">=</span>False)[<span style="color:#e6db74">&#39;median_date&#39;</span>]<span style="color:#f92672">.</span>dt<span style="color:#f92672">.</span>month<span style="color:#f92672">.</span>value_counts()<span style="color:#f92672">.</span>sort_index()
</code></pre></div><pre><code>7      1
8     23
9     42
10     1
Name: median_date, dtype: int64
</code></pre>
<p>The median storm date strictly measures an average storm date within year $Y$. Variation on the other hand measures average distance from the median storm date.  We measure distance from the median storm date in days.  Since some storms form before the median storm date and some storms after, we take the absolute value of the distance of each storm from the median storm date. Our MAD estimator is the median of the absolute values of these distances.  The last step scales our MAD estimator by $\frac{1}{\Phi^{-1}(0.75)} \approx 1.4826$, in a fairly standard assumption of normal data.  In the end, we have MAD estimates of the variation of the empirical storm season for each year in our data set.</p>
<p>To help visualize this calculation, consider the plot above.  For each storm (blue ticks), count the days between each storm and the median storm date (red tick), disregarding any potential negative signs.  From these counts, calculate the median and then scale it by $1.4826$.  This calcuation is done for each year, and we refer to the collection of yearly statistics as the MAD estimates.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">df[<span style="color:#e6db74">&#39;mad&#39;</span>] <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>apply(<span style="color:#66d9ef">lambda</span> x: np<span style="color:#f92672">.</span>abs((x[<span style="color:#e6db74">&#39;num_dates&#39;</span>] <span style="color:#f92672">-</span> x[<span style="color:#e6db74">&#39;median&#39;</span>])), axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)
sdf <span style="color:#f92672">=</span> (df[[<span style="color:#e6db74">&#39;year&#39;</span>, <span style="color:#e6db74">&#39;mad&#39;</span>]]<span style="color:#f92672">.</span>groupby(<span style="color:#e6db74">&#39;year&#39;</span>, as_index<span style="color:#f92672">=</span>False)
            <span style="color:#f92672">.</span>aggregate(<span style="color:#66d9ef">lambda</span> x: <span style="color:#ae81ff">1.4826</span><span style="color:#f92672">*</span>np<span style="color:#f92672">.</span>median(x)))
</code></pre></div><p>A plot of the MAD estimates across time appears below.  A non-zero slope would indicate a change in the variation of the empirical storm season across time.  Hence, to answer Dean Hassenzahl&rsquo;s question, we seek to quantify statistically the slope of these data.</p>
<p>A standard first attempt would fit simple linear regression to these data.  However, fitting linear regression to these data strictly ignores any possible correlation in storm seasons across time.  In this scenario, each year is treated as independent.  Recall, both Kossin and Kim treated their data as independent across time.</p>
<p>Treating each year as independent can be suspicious and can lead to over confident conclusions.  We are more interested in the semilocal linear trend model mentioned previously.  As a comparison, we fit linear regression and the semilocal linear trend model.</p>
<p>The plot below depicts the MAD estimates of the storm season by year in blue, with the estimate from linear regression overlayed in red.  The subtle negative slope indicates that, if anything, the variation of the emprical storm season is decreasing in time.  The negative sign of this slope agrees qualitatively with Kim, but disagrees with Kossin and Karloski.  Though we remind the reader that we are measureing the variation of the empirical storm season differently than Kossin and Karloski. Nevertheless, here we are most interested in the uncertainty of this slope estimate.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">reg <span style="color:#f92672">=</span> sm<span style="color:#f92672">.</span>OLS(sdf[<span style="color:#e6db74">&#39;mad&#39;</span>], sm<span style="color:#f92672">.</span>tools<span style="color:#f92672">.</span>add_constant(sdf[<span style="color:#e6db74">&#39;year&#39;</span>]))<span style="color:#f92672">.</span>fit()

fig, ax <span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>subplots(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">5</span>))
ax<span style="color:#f92672">.</span>cla()
bp<span style="color:#f92672">.</span>curve(sdf[<span style="color:#e6db74">&#39;year&#39;</span>], sdf[<span style="color:#e6db74">&#39;mad&#39;</span>], alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.5</span>)
bp<span style="color:#f92672">.</span>line(sdf[<span style="color:#e6db74">&#39;year&#39;</span>], reg<span style="color:#f92672">.</span>fittedvalues, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;tab:red&#39;</span>)
plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#39;Year&#39;</span>, fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">20</span>)
plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#39;MAD&#39;</span>, fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">20</span>)
plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#39;MAD of Storm Season by Year&#39;</span>, fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">20</span>)
plt<span style="color:#f92672">.</span>tight_layout()
</code></pre></div><p><img src="/post/stormevents_files/stormevents_31_0.png" alt=""></p>
<p>The plot above looks reasonable and the slope point estimate is reasonable given the uncertainty seen in that point estimate.  We should not focus on the p-value, rather we should focus on the standard error in the estimated coefficient year.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">reg<span style="color:#f92672">.</span>summary()
</code></pre></div><!-- raw HTML omitted -->
<p>The above regression output provides us a number of important summary statistics.  The slope is estimated to be $-0.007$ with a standard error one order of magnitude larger.  This indicates low confidence in the slope estimate.</p>
<p>The Durbin-Watson statistic is greater than 2, possibly indicating negative autocorrelation in these data, but there&rsquo;s likely to be high uncertainty in this statistic as well.</p>
<p>To build upon this simple regression model, we will allow possible autocorrelation in the data.  We next introduce the semilocal linear trend model.</p>
<h3 id="state-space-model">State Space Model</h3>
<p>A more sophisticated model for these data, such that we do not strictly rule out a correlation of the storm seasons across time, is the following Bayesian structural time series model. The semilocal linear trend model describes the time series of interest $y_{t}$ as</p>
<p>$$
\begin{aligned}
y_t &amp; = \mu_t + \epsilon_t \newline
\mu_{t+1} &amp; = \mu_t + \nu_t + \gamma_t \newline
\nu_{t+1} &amp; = \eta + \phi(\nu_t - \eta) + \zeta_t \newline
\epsilon_t &amp; \sim \mathbb{N}(0, \sigma_y^2) \newline
\gamma_t &amp; \sim \mathbb{N}(0, \sigma_{\mu}^2) \newline
\zeta_t &amp; \sim \mathbb{N}(0, \sigma_{\nu}^2) 
\end{aligned}
$$</p>
<p>where $\epsilon_t, \gamma_t$, and $\zeta_t$ are independent.  The notation $\mathbb{N}(0, \sigma^2)$ stands for a normal random variable with mean $0$ and variance $\sigma^2$.</p>
<p>The variable $\eta$, the long run slope in the time series, is of most interest.  Specifically, we allow deviations from the slope, $\nu_{t}$, so long as the deviations $\nu_{t}$ tend to revert back to the long run slope.  For more details on this model, consult <a href="https://www.amazon.com/Time-Analysis-State-Space-Methods/dp/019964117X/ref=pd_lpo_sbs_14_t_0?_encoding=UTF8&amp;psc=1&amp;refRID=BXZQ1XM11ZFFZDP4QVSP">Time Series Analysis by State Space Methods</a> and the <a href="https://cran.r-project.org/">R</a>  package <a href="https://cran.r-project.org/web/packages/bsts/index.html">bsts</a>&rsquo;s help page on their semilocal linear trend model or their blog post about the <a href="http://www.unofficialgoogledatascience.com/2017/07/fitting-bayesian-structural-time-series.html">semilocal linear trend model</a>.</p>
<p>Here, the time series of interest $y_t$ is the yearly MAD estimates of variation of the empirical storm season. Since this model will better handle possible correlations across time in the MAD estimates of variation, we will have an appropriate estimate of the variation in the long run slope.</p>
<p>In Stan, we write this model as follows.  The priors are discussed in the next subsection.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">local_linear <span style="color:#f92672">=</span> requests<span style="color:#f92672">.</span>get(<span style="color:#e6db74">&#39;https://raw.githubusercontent.com/roualdes/stormevents/master/semilocal_linear.stan&#39;</span>)<span style="color:#f92672">.</span>text
<span style="color:#66d9ef">print</span>(local_linear)
</code></pre></div><pre><code>data {
  int &lt;lower=1&gt; T;
  vector[T] x;
  vector[T] y;
}
transformed data {
  real sd_y = sd(y);
  real sd_x = sd(x);
}
parameters {
  real&lt;lower=0&gt; sigma_y;
  vector[T] gamma;
  real&lt;lower=0&gt; sigma_gamma;
  vector[T] zeta;
  real&lt;lower=0&gt; sigma_zeta;
  real eta;
  real&lt;lower=-1, upper=1&gt; phi;
}
transformed parameters {
  vector[T] mu;
  vector[T] nu;

  mu[1] = y[1] + sigma_gamma * gamma[1];
  nu[1] = zeta[1];
  for (t in 2:T) {
    mu[t] = mu[t-1] + nu[t-1] + sigma_gamma * gamma[t];
    nu[t] = eta + phi * (nu[t-1] - eta) + sigma_zeta * zeta[t];
  }
}
model {
  // likelihood
  y ~ normal(mu, sigma_y);

  // priors
  sigma_y ~ exponential(1 / sd_y);
  gamma ~ normal(0, 1);
  sigma_gamma ~ gamma(2, 1 / sd_y);
  zeta ~ normal(0, 1);
  sigma_zeta ~ gamma(2, 1 / sd_y);
  eta ~ student_t(3, 0, sd_y / sd_x);
  phi ~ normal(0, 0.5);
}
generated quantities {
  vector[T] y_pred;
  for (t in 1:T)
    y_pred[t] = normal_rng(mu[t], sigma_y);
}
</code></pre>
<p>In order to fit this model to the yearly variation in the storm season, we need to compile the above Stan program.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">stmod <span style="color:#f92672">=</span> pystan<span style="color:#f92672">.</span>StanModel(model_code<span style="color:#f92672">=</span>local_linear)
</code></pre></div><pre><code>INFO:pystan:COMPILING THE C++ CODE FOR MODEL anon_model_c5a67a1a28bbc98cedc1cecc2429214e NOW.
</code></pre>
<h4 id="model-priors">Model Priors</h4>
<p>The semilocal linear trend model above is fit as a Bayesian model, hence there are priors are on all parameters.  An effort has been made such that all priors are weakly informative.  We tried to follow a combination of the <a href="https://github.com/stan-dev/stan/wiki/Prior-Choice-Recommendations">guidelines established by the Stan community</a> and the default <a href="https://cran.r-project.org/web/packages/rstanarm/vignettes/priors.html">priors for rstanarm</a> [Stan-Development-Team:2016].</p>
<p>Specifically, the parameters $\sigma_y, \sigma_{\gamma}, \sigma_{\zeta}, \eta$, and $\phi$ have priors.  Let $y = (y_1, \ldots, y_T)'$ denote the observations of interest and $x$ be the x-axis values along which the observations $y$ are observed.</p>
<p>$$ 
\begin{align}
\sigma_y &amp; \sim \text{Exponential}(1 / \text{sd}(y) ) \newline
\sigma_{\gamma} &amp; \sim \Gamma(2, 1 / \text{sd}(y) ) \newline
\sigma_{\zeta} &amp; \sim \Gamma(2, 1 / \text{sd}(y) ) \newline
\eta &amp; \sim \mathbb{t}_3(0, \text{sd}(y) / \text{sd}(x) ) \newline
\phi &amp; \sim \mathbb{N}(0, 0.5) 
\end{align} 
$$</p>
<p>The prior on $\sigma_y$ attempts to match the scale of the standard deviation of the observations $y$ by scaling an $\text{Exponential(1)}$ distribution appropriately.  The scale parameters of $\gamma$ and $\zeta$ are given boundary avoiding priors and are scaled the same as $\sigma_y$. The prior on $\eta$ is treated as a regression coefficient in a multiple regression model and thus has a t-distribution on it with degrees of freedom that allow for as wide a distribution as possible with a finite variance.  Since $\eta$ is a slope parameter it is given the ratio of standard deviations of $y$ and $x$ to match the scale of a simple linear regression slope of $y$ on $x$.  The prior on $\phi$ attempts to weakly inform $\phi$ towards 0 with a standard deviation of 0.5.  This leaves room for the data to insist upon a posterior distribution on $\phi$ to be near the extremes $-1$ or $1$.</p>
<p>The above model is fit with Stan, and random samples from the joint posterior distribution over the model parameters are extracted.  We next evaluate the fit of the model and discuss the interpretation of the model in the context of the data.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">sdata <span style="color:#f92672">=</span> {                                                                            
    <span style="color:#e6db74">&#39;T&#39;</span>: sdf<span style="color:#f92672">.</span>shape[<span style="color:#ae81ff">0</span>], 
    <span style="color:#e6db74">&#39;x&#39;</span>: np<span style="color:#f92672">.</span>arange(sdf<span style="color:#f92672">.</span>shape[<span style="color:#ae81ff">0</span>]),
    <span style="color:#e6db74">&#39;y&#39;</span>: sdf[<span style="color:#e6db74">&#39;mad&#39;</span>]<span style="color:#f92672">.</span>values<span style="color:#f92672">.</span>ravel()
}
stfit <span style="color:#f92672">=</span> stmod<span style="color:#f92672">.</span>sampling(data<span style="color:#f92672">=</span>sdata,
                      control<span style="color:#f92672">=</span>{<span style="color:#e6db74">&#39;adapt_delta&#39;</span>: <span style="color:#f92672">.</span><span style="color:#ae81ff">99</span>})                                                                                                                                    
posterior <span style="color:#f92672">=</span> stfit<span style="color:#f92672">.</span>extract()  
</code></pre></div><pre><code>/Users/ez/py3/lib/python3.6/site-packages/pystan/misc.py:399: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  elif np.issubdtype(np.asarray(v).dtype, float):
</code></pre>
<p>Stan models, like many other sophisticated, statistical models, are susceptible to fitting problems. The interested reader may refer to Section 34 of the <a href="http://mc-stan.org/users/documentation/index.html">Stan reference manual</a> for further details.  For now, the checks below help assure us that this model applied to these data offer little to be concerned about.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">stan_utility<span style="color:#f92672">.</span>check_treedepth(stfit)
stan_utility<span style="color:#f92672">.</span>check_energy(stfit)
stan_utility<span style="color:#f92672">.</span>check_div(stfit)
stan_utility<span style="color:#f92672">.</span>check_rhat(stfit)
stan_utility<span style="color:#f92672">.</span>check_n_eff(stfit)
</code></pre></div><pre><code>0 of 4000 iterations saturated the maximum tree depth of 10 (0.0%)
E-BFMI indicated no pathological behavior
0.0 of 4000 iterations ended with a divergence (0.0%)
Rhat looks reasonable for all parameters
n_eff / iter looks reasonable for all parameters
</code></pre>
<p>The plot below superimposes our fitted model over the MAD estimates of the yearly variation of the empirical storm season.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">fig, ax <span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>subplots(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">5</span>))
ax<span style="color:#f92672">.</span>cla()                                                                         
bp<span style="color:#f92672">.</span>curve(sdf[<span style="color:#e6db74">&#39;year&#39;</span>], sdf[<span style="color:#e6db74">&#39;mad&#39;</span>], alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.5</span>)                                                   
bp<span style="color:#f92672">.</span>curve(sdf[<span style="color:#e6db74">&#39;year&#39;</span>], posterior[<span style="color:#e6db74">&#39;y_pred&#39;</span>]<span style="color:#f92672">.</span>mean(<span style="color:#ae81ff">0</span>), color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;tab:red&#39;</span>)                  
plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#39;MAD&#39;</span>, fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">20</span>)                                                              
plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#39;Year&#39;</span>, fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">20</span>)
plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#39;MAD of Storm Season by Year&#39;</span>, fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">20</span>)
plt<span style="color:#f92672">.</span>tight_layout()
</code></pre></div><p><img src="/post/stormevents_files/stormevents_47_0.png" alt=""></p>
<p>The variable $\eta$ defines the long run slope of the variation of the MAD estimates.  The point estimate of this model is similar to the point estimate from simple linear regression.  Here, however, we have an accurate estimate of the variation of the long run slope.</p>
<p>The median of the posterior distrbution of the long run slope, $\eta$, from the semilocal linear trend model is $.03$.  Below, $80$% and $95$% credible intervals provide estimates of error of $\eta$.  The density below, with $2.5, 10, 50, 90$, and $97.5$ percentiles drawn as short, blue ticks, depicts the posterior distribution of $\eta$.</p>
<p>We find evidence of a slight postive slope in MAD estimates across time.  The semilocal linear trend model shows that there is more noise in the estimate of slope than does simple linear regression.  With such high uncertainty, there is little evidence that the variation in the empirical storm season is getting significantly longer.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">eta_percentiles <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>percentile(posterior[<span style="color:#e6db74">&#39;eta&#39;</span>], [<span style="color:#ae81ff">2.5</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">50</span>, <span style="color:#ae81ff">90</span>, <span style="color:#ae81ff">97.5</span>])
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;Linear regression slope estimate: {}&#34;</span><span style="color:#f92672">.</span>format(reg<span style="color:#f92672">.</span>params[<span style="color:#ae81ff">1</span>]))
<span style="color:#66d9ef">print</span>(eta_percentiles)

fig, ax <span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>subplots(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">5</span>))
ax<span style="color:#f92672">.</span>cla()  
bp<span style="color:#f92672">.</span>density(posterior[<span style="color:#e6db74">&#39;eta&#39;</span>])
bp<span style="color:#f92672">.</span>rug(eta_percentiles)
plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#39;Density&#39;</span>, fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">20</span>)
plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#39;Posterior Distribution of $\eta$&#39;</span>, fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">20</span>)
plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#39;$\eta$&#39;</span>, fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">20</span>)
plt<span style="color:#f92672">.</span>tight_layout()
</code></pre></div><pre><code>Linear regression slope estimate: -0.006597090749461623
[-0.58850735 -0.33643296  0.0261598   0.35216475  0.58740378]
</code></pre>
<p><img src="/post/stormevents_files/stormevents_49_1.png" alt=""></p>
<p>In short, we have some evidence that the variation of the empirical storm season is not changing in time.</p>
<p>Nonetheless, there are other ways to address the idea of Dr. Hassenzahl&rsquo;s question.  Next, we investigate whether or not the proportion of storms occuring outside of the official storm season is changing in time.</p>
<h2 id="is-the-annual-percentage-of-storms-outside-official-storm-season-changing">Is the Annual percentage of storms outside official storm season changing?</h2>
<p>The official storm season is between June 01 and November 30.  In some years, all the storms form within the official storm season.  In other years, there are a few storms that form outside the official storm season.  Next, we consider the yearly percentage of storms that form outside of the official storm season.  This percentage is calculated for each year as follows.  Divide the number of storms that form outside the official storm season in a given year by the number of named storms that formed in that year and then multiply by 100.  If this yearly percentage were to trend up or down over time, we might believe that the variation of the empirical storm season were changing.</p>
<p>First, we calculate the percentage of storms forming outside of the official storm season for each year.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">outside_SS</span>(df):
    y <span style="color:#f92672">=</span> df[<span style="color:#e6db74">&#39;year&#39;</span>]<span style="color:#f92672">.</span>values[<span style="color:#ae81ff">0</span>]
    early <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>sum(df[<span style="color:#e6db74">&#39;date&#39;</span>] <span style="color:#f92672">&lt;</span> datetime<span style="color:#f92672">.</span>datetime(y, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">1</span>))
    late <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>sum(df[<span style="color:#e6db74">&#39;date&#39;</span>] <span style="color:#f92672">&gt;</span> datetime<span style="color:#f92672">.</span>datetime(y, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">30</span>))
    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">100</span> <span style="color:#f92672">*</span> (early <span style="color:#f92672">+</span> late) <span style="color:#f92672">/</span> df[<span style="color:#e6db74">&#39;year&#39;</span>]<span style="color:#f92672">.</span>shape[<span style="color:#ae81ff">0</span>]

sdf[<span style="color:#e6db74">&#39;prop&#39;</span>] <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>groupby(<span style="color:#e6db74">&#39;year&#39;</span>, as_index<span style="color:#f92672">=</span>False)<span style="color:#f92672">.</span>apply(outside_SS)
</code></pre></div><p>Plotting these percentages over time shows that there are plenty of years where 0 storms formed outside of the official storm season. In no years were all the storms outside of the official storm season.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">reg <span style="color:#f92672">=</span> sm<span style="color:#f92672">.</span>OLS(sdf[<span style="color:#e6db74">&#39;prop&#39;</span>], sm<span style="color:#f92672">.</span>tools<span style="color:#f92672">.</span>add_constant(sdf[<span style="color:#e6db74">&#39;year&#39;</span>]))<span style="color:#f92672">.</span>fit()

fig, ax <span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>subplots(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">5</span>))
ax<span style="color:#f92672">.</span>cla()
bp<span style="color:#f92672">.</span>curve(sdf[<span style="color:#e6db74">&#39;year&#39;</span>], sdf[<span style="color:#e6db74">&#39;prop&#39;</span>])
bp<span style="color:#f92672">.</span>line(sdf[<span style="color:#e6db74">&#39;year&#39;</span>], reg<span style="color:#f92672">.</span>fittedvalues, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;tab:red&#39;</span>)
plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#39;Year&#39;</span>, fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">20</span>)
plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#39;Percentage&#39;</span>, fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">20</span>)
plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#39;Percentage of Storms Outside of Official Storm Season by Year&#39;</span>, fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">20</span>)
plt<span style="color:#f92672">.</span>tight_layout()
</code></pre></div><p><img src="/post/stormevents_files/stormevents_55_0.png" alt=""></p>
<p>We analyze these percentages using the same semilocal linear trend model as above.    If the slope parameter $\eta$ is significantly non-zero, we&rsquo;ll have found some evidence in a changing proportion of storms occuring outside of the official storm season.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">sdata <span style="color:#f92672">=</span> {                                                                            
    <span style="color:#e6db74">&#39;T&#39;</span>: sdf<span style="color:#f92672">.</span>shape[<span style="color:#ae81ff">0</span>], 
    <span style="color:#e6db74">&#39;x&#39;</span>: np<span style="color:#f92672">.</span>arange(sdf<span style="color:#f92672">.</span>shape[<span style="color:#ae81ff">0</span>]),
    <span style="color:#e6db74">&#39;y&#39;</span>: sdf[<span style="color:#e6db74">&#39;prop&#39;</span>]
}
stfit <span style="color:#f92672">=</span> stmod<span style="color:#f92672">.</span>sampling(data<span style="color:#f92672">=</span>sdata,
                      control<span style="color:#f92672">=</span>{<span style="color:#e6db74">&#39;adapt_delta&#39;</span>: <span style="color:#f92672">.</span><span style="color:#ae81ff">99</span>}) 
posterior <span style="color:#f92672">=</span> stfit<span style="color:#f92672">.</span>extract() 
</code></pre></div><pre><code>/Users/ez/py3/lib/python3.6/site-packages/pystan/misc.py:399: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  elif np.issubdtype(np.asarray(v).dtype, float):
</code></pre>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">stan_utility<span style="color:#f92672">.</span>check_treedepth(stfit)
stan_utility<span style="color:#f92672">.</span>check_energy(stfit)
stan_utility<span style="color:#f92672">.</span>check_div(stfit)
stan_utility<span style="color:#f92672">.</span>check_rhat(stfit)
stan_utility<span style="color:#f92672">.</span>check_n_eff(stfit)
</code></pre></div><pre><code>0 of 4000 iterations saturated the maximum tree depth of 10 (0.0%)
E-BFMI indicated no pathological behavior
0.0 of 4000 iterations ended with a divergence (0.0%)
Rhat looks reasonable for all parameters
n_eff / iter looks reasonable for all parameters
</code></pre>
<p>The plot below displays the semilocal linear trend estimates of the percentages of storms that formed outside of the official storm season.  The model estimates are drawn in red and are superimposed over the light blue observations.  It appears to have a gentle positive slope.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">fig, ax <span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>subplots(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">5</span>))
ax<span style="color:#f92672">.</span>cla()                                                                         
bp<span style="color:#f92672">.</span>curve(sdf[<span style="color:#e6db74">&#39;year&#39;</span>], sdf[<span style="color:#e6db74">&#39;prop&#39;</span>], alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.5</span>)                                                   
bp<span style="color:#f92672">.</span>curve(sdf[<span style="color:#e6db74">&#39;year&#39;</span>], posterior[<span style="color:#e6db74">&#39;y_pred&#39;</span>]<span style="color:#f92672">.</span>mean(<span style="color:#ae81ff">0</span>), color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;tab:red&#39;</span>)                  
plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#39;Percentage&#39;</span>, fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">20</span>)                                                              
plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#39;Year&#39;</span>, fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">20</span>)
plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#39;Percentage of Storms Outside of Official Storm Season by Year&#39;</span>, fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">20</span>)
plt<span style="color:#f92672">.</span>tight_layout()
</code></pre></div><p><img src="/post/stormevents_files/stormevents_60_0.png" alt=""></p>
<p>The posterior distribution of $\eta$ appears below, alongside multiple percentiles.  While the median of $\eta$ is positive, even the $80$% credible interval includes 0.  While I certainly don&rsquo;t want to make a binary conclusion here, it appears that there is much noise in the estimate of the long term slope parameter $\eta$.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">eta_percentiles <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>percentile(posterior[<span style="color:#e6db74">&#39;eta&#39;</span>], [<span style="color:#ae81ff">2.5</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">50</span>, <span style="color:#ae81ff">90</span>, <span style="color:#ae81ff">97.5</span>])
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;Linear regression slope estimate: {}&#34;</span><span style="color:#f92672">.</span>format(reg<span style="color:#f92672">.</span>params[<span style="color:#ae81ff">1</span>]))
<span style="color:#66d9ef">print</span>(eta_percentiles)

fig, ax <span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>subplots(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">5</span>))
ax<span style="color:#f92672">.</span>cla()  
bp<span style="color:#f92672">.</span>density(posterior[<span style="color:#e6db74">&#39;eta&#39;</span>])
bp<span style="color:#f92672">.</span>rug(eta_percentiles)
plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#39;Density&#39;</span>, fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">20</span>)
plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#39;$\eta$&#39;</span>, fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">20</span>)
plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#39;Posterior Distribution of $\eta$&#39;</span>, fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">20</span>)
plt<span style="color:#f92672">.</span>tight_layout()
</code></pre></div><pre><code>Linear regression slope estimate: -0.0038128475204844752
[-0.4140813  -0.22224445  0.02994714  0.28013784  0.44618868]
</code></pre>
<p><img src="/post/stormevents_files/stormevents_62_1.png" alt=""></p>
<p>It doesn&rsquo;t appear that the percentage of storms occuring outside of the official storm season is changing over time.</p>
<p>Last, we analyze the stationarity of the empirical storm season.</p>
<h2 id="is-the-distribution-of-the-empirical-storm-season-stationary">Is the Distribution of the Empirical Storm Season Stationary?</h2>
<p>Consider the average density <a href="#average_density">histogram</a> above, where the empirical storm season was averaged over all the years for which we have data.  Let&rsquo;s refer to this histogram as the average storm season.  If the empirical storm season was not changing over time, then this average storm season would represent the stationary distribution from which each year&rsquo;s storm season was randomly drawn.  If such a stationary storm season producing distribution exists, then no year&rsquo;s storm season in our data set should be too different from the average storm season.</p>
<p>To evaluate the stationarity of the storm season, we compute such a histogram for each year&rsquo;s empirical storm season separately.  For instance, consider the <a href="#2005_density">histogram of the storms from 2005</a>.  Now imagine we overlayed the average storm season histogram with the histogram from the 2005 storm season.  We calculate the maximal, absolute difference between these two histograms.  This idea is most easily visualized with histograms, but in fact we do all the calculations with the empirical cumulative distribution functions of the empirical storm seasons.  Intuitively, these ideas are similar.  In fact, this is just the <a href="https://en.wikipedia.org/wiki/Kolmogorov%E2%80%93Smirnov_test">Kolmogorov-Smirnov</a> (KS) statistic, for each year&rsquo;s storm season relative to the average storm season.</p>
<p>We walk through each step of the calculations involved.  First, we calculate the average storm season.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">hist, bins <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>histogram(df[<span style="color:#e6db74">&#39;cnum_dates&#39;</span>], 
                          bins<span style="color:#f92672">=</span>df[<span style="color:#e6db74">&#39;cnum_dates&#39;</span>]<span style="color:#f92672">.</span>nunique(), density<span style="color:#f92672">=</span>True)
cdf <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>cumsum(hist)
ecdf <span style="color:#f92672">=</span> cdf<span style="color:#f92672">/</span>cdf[<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]
</code></pre></div><p>Next, we&rsquo;ll replicate this calculation for each year in our data set.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">ks <span style="color:#f92672">=</span> []
<span style="color:#66d9ef">for</span> year <span style="color:#f92672">in</span> np<span style="color:#f92672">.</span>nditer(df[<span style="color:#e6db74">&#39;date&#39;</span>]<span style="color:#f92672">.</span>dt<span style="color:#f92672">.</span>year<span style="color:#f92672">.</span>unique()):
    h, _ <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>histogram(df[<span style="color:#e6db74">&#39;cnum_dates&#39;</span>][df[<span style="color:#e6db74">&#39;date&#39;</span>]<span style="color:#f92672">.</span>dt<span style="color:#f92672">.</span>year <span style="color:#f92672">==</span> year], 
                        bins<span style="color:#f92672">=</span>df[<span style="color:#e6db74">&#39;cnum_dates&#39;</span>]<span style="color:#f92672">.</span>nunique(), density<span style="color:#f92672">=</span>True)
    bcdf <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>cumsum(h)
    ks<span style="color:#f92672">.</span>append(np<span style="color:#f92672">.</span>max(np<span style="color:#f92672">.</span>abs(ecdf <span style="color:#f92672">-</span> bcdf<span style="color:#f92672">/</span>bcdf[<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>])))
sdf[<span style="color:#e6db74">&#39;KS&#39;</span>] <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array(ks)<span style="color:#f92672">*</span><span style="color:#ae81ff">100</span>
</code></pre></div><p>The plot below displays the year over year KS statistics.  There appears to be a negative slope over time.  We remind the reader that the yearly KS statistics appear in absolute value.  Hence, a (possible) negative slope is not as indicative as the word negative connotes.  Here, any slope, positive or negative, will simply suggest a non-stationary storm season.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">reg <span style="color:#f92672">=</span> sm<span style="color:#f92672">.</span>OLS(sdf[<span style="color:#e6db74">&#39;KS&#39;</span>], sm<span style="color:#f92672">.</span>tools<span style="color:#f92672">.</span>add_constant(sdf[<span style="color:#e6db74">&#39;year&#39;</span>]))<span style="color:#f92672">.</span>fit()

fig, ax <span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>subplots(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">5</span>))
ax<span style="color:#f92672">.</span>cla()
bp<span style="color:#f92672">.</span>curve(sdf[<span style="color:#e6db74">&#39;year&#39;</span>], sdf[<span style="color:#e6db74">&#39;KS&#39;</span>], alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.5</span>)
bp<span style="color:#f92672">.</span>line(sdf[<span style="color:#e6db74">&#39;year&#39;</span>], reg<span style="color:#f92672">.</span>fittedvalues, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;tab:red&#39;</span>)
plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#39;Year&#39;</span>, fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">20</span>)
plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#39;KS&#39;</span>, fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">20</span>)
plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#39;KS Statistics by Year&#39;</span>, fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">20</span>)
plt<span style="color:#f92672">.</span>tight_layout()
</code></pre></div><p><img src="/post/stormevents_files/stormevents_70_0.png" alt=""></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">sdata <span style="color:#f92672">=</span> {                                                                            
    <span style="color:#e6db74">&#39;T&#39;</span>: sdf<span style="color:#f92672">.</span>shape[<span style="color:#ae81ff">0</span>], 
    <span style="color:#e6db74">&#39;x&#39;</span>: np<span style="color:#f92672">.</span>arange(sdf<span style="color:#f92672">.</span>shape[<span style="color:#ae81ff">0</span>]),
    <span style="color:#e6db74">&#39;y&#39;</span>: sdf[<span style="color:#e6db74">&#39;KS&#39;</span>]
}
stfit <span style="color:#f92672">=</span> stmod<span style="color:#f92672">.</span>sampling(data<span style="color:#f92672">=</span>sdata, 
                       control<span style="color:#f92672">=</span>{<span style="color:#e6db74">&#39;adapt_delta&#39;</span>: <span style="color:#f92672">.</span><span style="color:#ae81ff">99</span>,
                                <span style="color:#e6db74">&#39;max_treedepth&#39;</span>: <span style="color:#ae81ff">15</span>}) 
posterior <span style="color:#f92672">=</span> stfit<span style="color:#f92672">.</span>extract()
</code></pre></div><pre><code>/Users/ez/py3/lib/python3.6/site-packages/pystan/misc.py:399: FutureWarning: Conversion of the second argument of issubdtype from `float` to `np.floating` is deprecated. In future, it will be treated as `np.float64 == np.dtype(float).type`.
  elif np.issubdtype(np.asarray(v).dtype, float):
</code></pre>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">stan_utility<span style="color:#f92672">.</span>check_treedepth(stfit, max_depth<span style="color:#f92672">=</span><span style="color:#ae81ff">15</span>)
stan_utility<span style="color:#f92672">.</span>check_energy(stfit)
stan_utility<span style="color:#f92672">.</span>check_div(stfit)
stan_utility<span style="color:#f92672">.</span>check_rhat(stfit)
stan_utility<span style="color:#f92672">.</span>check_n_eff(stfit)
</code></pre></div><pre><code>0 of 4000 iterations saturated the maximum tree depth of 15 (0.0%)
E-BFMI indicated no pathological behavior
2.0 of 4000 iterations ended with a divergence (0.05%)
  Try running with larger adapt_delta to remove the divergences
Rhat looks reasonable for all parameters
n_eff / iter looks reasonable for all parameters
</code></pre>
<p>The semilocal linear trend model smoothes out the yearly KS statistics.  Similar to linear regression, there appears to be a negative slope.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">fig, ax <span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>subplots(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">5</span>))
ax<span style="color:#f92672">.</span>cla()                                                                         
bp<span style="color:#f92672">.</span>curve(sdf[<span style="color:#e6db74">&#39;year&#39;</span>], sdf[<span style="color:#e6db74">&#39;KS&#39;</span>], alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.5</span>)                                                   
bp<span style="color:#f92672">.</span>curve(sdf[<span style="color:#e6db74">&#39;year&#39;</span>], posterior[<span style="color:#e6db74">&#39;y_pred&#39;</span>]<span style="color:#f92672">.</span>mean(<span style="color:#ae81ff">0</span>), color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;tab:red&#39;</span>)  
plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#39;KS&#39;</span>, fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">20</span>)                                                              
plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#39;Year&#39;</span>, fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">20</span>)
plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#39;KS Statistics by Year&#39;</span>, fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">20</span>)
plt<span style="color:#f92672">.</span>tight_layout()
</code></pre></div><p><img src="/post/stormevents_files/stormevents_74_0.png" alt=""></p>
<p>The posterior distribution of $\eta$ is noisy, despite the negative median value.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">eta_percentiles <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>percentile(posterior[<span style="color:#e6db74">&#39;eta&#39;</span>], [<span style="color:#ae81ff">2.5</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">50</span>, <span style="color:#ae81ff">90</span>, <span style="color:#ae81ff">97.5</span>])
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;Linear regression slope estimate: {}&#34;</span><span style="color:#f92672">.</span>format(reg<span style="color:#f92672">.</span>params[<span style="color:#ae81ff">1</span>]))
<span style="color:#66d9ef">print</span>(eta_percentiles)

fig, ax <span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>subplots(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">5</span>))
ax<span style="color:#f92672">.</span>cla()  
bp<span style="color:#f92672">.</span>density(posterior[<span style="color:#e6db74">&#39;eta&#39;</span>])
bp<span style="color:#f92672">.</span>rug(eta_percentiles)
plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#39;Density&#39;</span>, fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">20</span>)
plt<span style="color:#f92672">.</span>title(<span style="color:#e6db74">&#39;Posterior Distribution of $\eta$&#39;</span>, fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">20</span>)
plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#39;$\eta$&#39;</span>, fontsize<span style="color:#f92672">=</span><span style="color:#ae81ff">20</span>)
plt<span style="color:#f92672">.</span>tight_layout()
</code></pre></div><pre><code>Linear regression slope estimate: -0.004147888339256261
[-0.83684908 -0.50679053 -0.0118629   0.46288992  0.80493632]
</code></pre>
<p><img src="/post/stormevents_files/stormevents_76_1.png" alt=""></p>
<p>We find little evidence that the empirical storm season is non-stationary, since the posterior distribution of $\eta$ is so noisy about $0$.</p>
<h1 id="conclusion">Conclusion</h1>
<p>This blog post analyzed the variation of the empirical storm season in multiple, novel ways.  First, we considered the MAD estimates of the variation of the empirical storm season.  Second, we analyzed the percentage of storms that occured outside of the official storm season.  Neither of these analyses found evidence of significant changes in the variation of the empirical storm season.</p>
<p>The last analysis considered the stationarity of the empirical storm season by investigating the slope of the yearly maximal discrepancy between the average storm season and each year&rsquo;s storm season.  Here, we calculated one KS statistic for each year in our data set.  Unlike the first two analyses, the KS statistic will identify any changes in distribution, not just the variance.  Yet, even with the yearly KS statistics, we still didn&rsquo;t find any significant changes in the empirical storm season.  Though not displayed, similar results hold for the storms in the Pacific Ocean.  The analysis here is easily adapted to storms from the Pacific Ocean; in fact the starting data set includes storms from both oceans.</p>
<p>A strong word of caution is in order.  None of the work here said anything about the <a href="https://www.ncdc.noaa.gov/news/tropical-cyclone-%E2%80%9Cmaximum-intensity%E2%80%9D-shifting-toward-poles">intensity of storms</a>, nor the length of storms, nor the <a href="https://www.ncei.noaa.gov/news/tropical-cyclone-slowdown">speed of storms</a>, nor changes in anything that may influence storms [Karloski:2016].  In part, our focus on the variation of the empirical storm makes this analysis unique.  However, as we largely didn&rsquo;t discover any broad changes in the empirical storm season, we didn&rsquo;t find much of interest.  Which is to say, there may be a reason so many other people have focused their attention elsewhere; that&rsquo;s where all the interesting things are happening.</p>
<h1 id="acknowledgments">Acknowledgments</h1>
<p>This blog post would not have happened without the great minds of Dave Hassenzahl, Ann Bykerk-Kauffman, and the Department of Geological and Environmental Sciences.  Thanks goes out to Rachel Hensler, Robin Donatello, Kristen Kaczynski, Rachel Teasdale, and Cab Esposito for their helpful feedback.  And of course, the communities of Python, Stan, and NOAA&rsquo;s National Hurricane Center deserve much credit for their endless hard work.</p>
<h1 id="references">References</h1>
<ul>
<li>[Carpenter:2017] B. Carpenter, A. Gelman, M. D. Hoffman, D. Lee, B. Goodrich, M. Betancourt, M. Brubaker, J. Guo, P. Li, and A. Riddell. Stan: A probabilistic programming language. Journal of statistical software, 76(1), 2017. <a href="https://www.jstatsoft.org/article/view/v076i01">https://www.jstatsoft.org/article/view/v076i01</a></li>
<li>[Durbin:2012] J. Durbin and S. J. Koopman. Time Series Analysis by State Space Methods. Oxford University Press, 2 edition, 2012.</li>
<li>[Karloski:2016] J. M. Karloski and C. Evans. Seasonal influences upon and long-term trends in the length of the atlantic hurricane season. Journal of Climate, 29(1):273–292, 2016.  <a href="https://journals.ametsoc.org/doi/abs/10.1175/JCLI-D-15-0324.1">https://journals.ametsoc.org/doi/abs/10.1175/JCLI-D-15-0324.1</a></li>
<li>[Kim:2017] D. Kim, H.-S. Kim, D.-S. R. Park, and M.-S. Park. Variation of the tropical cyclone season start in the western north pacific. Journal of Climate, 30(9):3297–3302, 2017. <a href="https://journals.ametsoc.org/doi/full/10.1175/JCLI-D-16-0888.1">https://journals.ametsoc.org/doi/full/10.1175/JCLI-D-16-0888.1</a></li>
<li>[Kossin:2008] J. P. Kossin. Is the north atlantic hurricane season getting longer? Geophysical Research Letters, 35(23), 2008. <a href="https://agupubs.onlinelibrary.wiley.com/doi/abs/10.1029/2008GL036012">https://agupubs.onlinelibrary.wiley.com/doi/abs/10.1029/2008GL036012</a></li>
<li>[Landsea:2013] C. W. Landsea and J. L. Franklin. Atlantic hurricane database uncertainty and presentation of a new database format. Monthly Weather Review, 141(10):3576–3592, 2013. <a href="https://journals.ametsoc.org/doi/10.1175/MWR-D-12-00254.1">https://journals.ametsoc.org/doi/10.1175/MWR-D-12-00254.1</a></li>
<li>[R-Core-Team:2018] R Core Team. R: A Language and Environment for Statistical Computing. R Foundation for Statistical Computing, Vienna, Austria, 2018. <a href="https://www.R-project.org">https://www.R-project.org</a></li>
<li>[Stan-Development-Team:2016] Stan Development Team. rstanarm: Bayesian applied regression modeling via Stan., 2016. R package version 2.13.1. <a href="http://mc-stan.org/rstanarm/index.html">http://mc-stan.org/rstanarm/index.html</a></li>
<li>[Scott:2018] S. L. Scott. bsts: Bayesian Structural Time Series, r package version 0.8.0 edition, 2018. <a href="https://CRAN.R-project.org/package=bsts">https://CRAN.R-project.org/package=bsts</a></li>
</ul>
<h1 id="licenses">Licenses</h1>
<ul>
<li>Code: Copyright (2018) California State University, Chico. Released under the BSD 3-clause license. <a href="https://opensource.org/licenses/BSD-3-Clause">https://opensource.org/licenses/BSD-3-Clause</a></li>
<li>Text: Copyright (2018) Edward A. Roualdes. Released under the the CC BY-NC 4.0 license. <a href="https://creativecommons.org/licenses/by-nc/4.0/legalcode">https://creativecommons.org/licenses/by-nc/4.0/legalcode</a></li>
</ul>

</div>

        <footer class="post-footer clearfix">
    
        <p class="post-tags">
            <span>Tagged:</span>
            
            
                <a href="/tags/storms/">storms</a>, 
            
                <a href="/tags/python/">python</a>, 
            
                <a href="/tags/variance/">variance</a>
            
        </p>
    

    <div class="share">
        
            <a class="icon-twitter" href="https://twitter.com/share?text=Measuring%20Variation%20in%20the%20Empirical%20Storm%20Season%20Over%20Time&url=%2f2018%2f07%2f18%2f2018-07-18-storm-events%2f"
                onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
                <i class="fa fa-twitter"></i>
                <span class="hidden">Twitter</span>
            </a>
        

        
            <a class="icon-facebook" href="https://www.facebook.com/sharer/sharer.php?u=%2f2018%2f07%2f18%2f2018-07-18-storm-events%2f"
                onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
                <i class="fa fa-facebook"></i>
                <span class="hidden">Facebook</span>
            </a>
        

        
            <a class="icon-google-plus" href="https://plus.google.com/share?url=%2f2018%2f07%2f18%2f2018-07-18-storm-events%2f"
              onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
              <i class="fa fa-google-plus"></i>
                <span class="hidden">Google+</span>
            </a>
        
        
    </div>
</footer>

        
    <div class="comments">
        <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "XXX" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    </div>

    </article>
</div>

            </div>
        </div>

        <footer class="footer">
            <div class="container">
                <div class="site-title-wrapper">
                    <h1 class="site-title">
                        <a title="CSUC DSI" href="/">CSUC DSI</a>
                    </h1>
                    <a class="button-square button-jump-top js-jump-top" href="#">
                        <i class="fa fa-angle-up"></i>
                    </a>
                </div>

                <p class="footer-copyright">
                    <span>&copy; 2020 / Powered by <a href="https://gohugo.io/">Hugo</a></span>
                </p>
                <p class="footer-copyright">
                    <span><a href="https://github.com/roryg/ghostwriter">Ghostwriter theme</a> By <a href="http://jollygoodthemes.com">JollyGoodThemes</a></span>
                    <span>/ <a href="https://github.com/jbub/ghostwriter">Ported</a> to Hugo By <a href="https://github.com/jbub">jbub</a></span>
                </p>
            </div>
        </footer>

        <script src="/js/jquery-1.11.3.min.js"></script>
        <script src="/js/jquery.fitvids.js"></script>
        
        
            <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        
        
        <script src="/js/scripts.js"></script>
   

    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        extensions: ["tex2jax.js"],
        jax: ["input/TeX", "output/HTML-CSS"],
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"] ],
          displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
          processEscapes: true
        },
        "HTML-CSS": { fonts: ["TeX"] }
      });
    </script>
    <script type="text/javascript" async
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML">
    </script>



    </body>
</html>


  
